{% extends 'pase.html' %}
{% load static %}
{% block contant %}

    <div class="container">
    <div class="d-flex align-items-center mb-3">
    <div class="container mt-5">
        <h1>Send Message</h1>
        <!-- Message Form -->
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group">
                <label for="postDescription">Write your message</label>
                <textarea class="form-control" id="sent" name="user_message" rows="6" placeholder="Here" required></textarea>
            </div>
            <input type="hidden" name="sender_id" value="{{ sender_id }}">
            <div class="form-group">
                <label for="recipient_id">Choose recipient:</label>

                <select class="form-control" id="recipient_id" name="recipient_id" required>
                 <option value="3">Elderbazy</option>
                <option value="3">Ali Mohamed</option>
                 <option value="3">Ahmed Othman</option>
                <option value="3">Mohamed Ahmed</option>
                    <option value="3">Dalia Hassan</option>
                <option value="3">Sarah Ahmed</option>
                    <option value="3">Eaktrina Vladimerva</option>
                <option value="3">sadasd</option>
                    {% for user in users %}
                    {% endfor %}
                </select>



            </div>


        </form>
     <button id="sendButton" type="submit" name="Send_message"  class="btn btn-primary">Send</button>
      <p class="text-center fs-4  my-4 text-success" id="message">


            </p>
    </div>
</div>


    <h1>User Messages</h1>
    {% if user.is_authenticated %}
        {% for message in message %}
      <div class="message">
        <p><strong>From:</strong> {{ message.sender.username }}</p>
        <p><strong>Content:</strong> {{ message.text }}</p>
        <p><strong>Timestamp:</strong> {{ message.timestamp }}</p>
        {% if message.is_read %}
          <p class="status-read"><strong>Status:</strong> Read</p>
        {% else %}
          <p class="status-unread"><strong>Status:</strong> Unread</p>
        {% endif %}
        <form method="POST" action="{% url 'markread' massage_id=message.id %}" style="display: inline;">
             {% csrf_token %}
            <button type="submit" class="read-button">Mark as Read</button>
        </form>
        <form method="post" action="{% url 'delet' delet_id=message.id %}" style="display: inline;">
          {% csrf_token %}
          <button type="submit" class="delete-button">Delete</button>
        </form>
      </div>
      <hr>
    {% endfor %}

        {% if messages|length == 0 %}
          <p class="no-messages">No messages to display.</p>
        {% endif %}
    {% endif %}
  </div>

  <style>
    .container {
      max-width: 800px;
      margin: auto;
    }

    .message {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 20px;
      position: relative;
    }

    .status-read {
      color: green;
    }

    .status-unread {
      color: red;
      font-weight: bold;
    }

    .delete-button {
      background-color: #ff6b6b;
      color: #fff;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 10px;
    }

    .no-messages {
      font-style: italic;
      color: #666;
    }
     .success-message {
    color: green;
  }
  </style>
<script>
var text = document.getElementById("sent");
document.getElementById("sendButton").onclick = function() {
  var messageElement = document.getElementById("message");
  messageElement.textContent = "The message has been sent successfully.";
text.value = ""
};
</script>
{% endblock %}
